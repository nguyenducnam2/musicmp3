<!DOCTYPE html>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{client/layout.html}">
    <body>
        <div layout:fragment="content" id="content-page" class="content-page">
            <div class="container-fluid">
                <div class="row">
                    <div class="col-lg-12">
                        <div class="iq-card">
                            <div class="iq-card-header d-flex justify-content-between align-items-center">
                                <div class="iq-header-title">
                                    <h4 id="name" class="card-title"></h4>
                                </div>
                                <div id="feature-album-slick-arrow" class="slick-aerrow-block">
                                    <button class="btn btn-primary" onclick="getList()">Refresh</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-12">
                    <div class="iq-card">
                        <div class="iq-card-body">
                            <ul class="list-unstyled iq-music-slide mb-0" id="main-root">

                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <input type="hidden" id="genreId" th:value="${genreId}"/>
            <script>
                let main = document.querySelector('#main-root');
                let name = document.querySelector('#name');
                function getList() {
                    fetch(`http://localhost:8080/api/genre/getSongById?id=` + document.querySelector('#genreId').value, {method: "GET"})
                            .then((response) => response.json())
                            .then((response) => {
                                name.innerHTML = "<p>Random List: " + response[0].genre.name + "</p>"
                                main.innerHTML = "";
                                for (let i = 0; i < response.length; i++) {
                                    main.innerHTML += "<li class='mb-3'><div class='d-flex justify-content-between align-items-center row'><div class='media align-items-center col-10 col-md-5'><div class='iq-realese-song'><a href='http://localhost:8080/song/" + response[i].id + "'><img src='http://localhost:8080/webdata/album/" + response[i].album.image + "' class='img-border-radius avatar-60 img-fluid'></a></div><div class='media-body ml-3'><p class='mb-0'>" + response[i].name + "</p><small>" + response[i].artist.name + "</small></div></div><p class='mb-0 col-md-2 col-md-2 iq-music-time'><div data-icon='&#xe003;' class='icon'>  " + response[i].view + "</div></p><p class='mb-0 col-2 col-md-2 iq-music-play'><a href='http://localhost:8080/song/" + response[i].id + "'><i class='las la-play-circle font-size-32'></i></a></p></div></li>";
                                }
                            })
                            .catch(e => {
                                console.log(e);
                                main.innerHTML = "<p>This Genre Has No Song</p>";
                            });
                }
                getList();
            </script>
        </div>
    </body>
</html>
